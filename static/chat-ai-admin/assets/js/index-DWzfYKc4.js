import{_ as G,b as he,L as ge,d as T,M as K,m as ae,n as ke,r as we,a as ye,o as be,E as se,p as Ce,B as oe,q as xe,t as Ae,v as Ue,w as Oe}from"../../index-3zhUo7yB.js";import{r as y,L as p,M,F as X,a1 as q,a2 as Se,Y as k,u as x,w as Pe,j as e,Q as a,P as E,V as m,a3 as le,a4 as ne,A as z,U as R,X as L,a8 as W,a9 as re,a6 as Ie,b as Be}from"./vue-chunks-BqR2sv6q.js";import{v as ue}from"./validate-CYzfr11z.js";import{F as N,I as ie,_ as J,a as de}from"./Password-B44zxURS.js";import{P as ee}from"./PlusOutlined-C0SjZwHg.js";import{_ as Le}from"./index-DtZiJi1p.js";import{_ as ce}from"./index-DD-RdiGP.js";import{S as Me,_ as Fe}from"./index-iNvt8ZKo.js";import{a as _e}from"./dayjs-CuJbp_-a.js";import{_ as te}from"./index-BaW8XISn.js";import{_ as pe,a as me}from"./index-ej_sHyoU.js";import{_ as De}from"./TextArea-DzoZEWPA.js";import{C as Ee,_ as Re}from"./index-C9syL6S-.js";import{_ as ze,a as Ge}from"./index-DOPipcFx.js";import"./axios-Cm0UX6qg.js";import"./qs-B6vlU9Aj.js";import"./crypto-js-Dyh51M5x.js";import"./index-Ds1Q0oJ4.js";import"./collapseMotion-CZutXYv2.js";import"./inputProps-C4OjRA3_.js";import"./FormItemContext-BTP630fU.js";import"./CheckOutlined-BEWUgocd.js";import"./useRefs-BBK5dDsO.js";import"./slide-ZCl6ZFDX.js";import"./index-iH-Nu7mF.js";import"./isMobile-D_4OiXLP.js";import"./DownOutlined-BGIGKQLl.js";import"./move-MIaOwSfN.js";import"./index-vrWa0o1m.js";import"./LeftOutlined-BNSG1iTg.js";import"./RightOutlined-GbTdcqbp.js";import"./index-BnvbLpNa.js";import"./dropdown-BzleFHKH.js";import"./Dropdown-dAJ9ZCrS.js";import"./index-BRrao2Ax.js";import"./index-C7obNtrF.js";const Te={class:"page-tabs"},Ne=["onClick"],He={__name:"page-tabs",props:{value:{type:[Number,String]}},emits:["update:value","change"],setup(P,{emit:c}){const{t:O}=he(),v=c,I=P,u=y([{value:1,title:O("views.user.model.teamMembers"),langKey:"views.user.model.teamMembers"},{value:0,title:O("views.user.model.rolePermissions"),langKey:"views.user.model.rolePermissions"}]),w=t=>{v("update:value",t),v("change",t)};return(t,B)=>(p(),M("div",Te,[(p(!0),M(X,null,q(u.value,A=>(p(),M("div",{class:Se(["tab-item",{active:I.value==A.value}]),onClick:g=>w(A.value),key:A.value},k(x(O)(A.langKey)),11,Ne))),128))]))}},Xe=G(He,[["__scopeId","data-v-e344f7b9"]]),qe=P=>(le("data-v-c21fed10"),P=P(),ne(),P),Ke={class:"avatar-uploader"},je=["src"],Ve={key:1},Ye=qe(()=>m("div",{class:"ant-upload-text"},"上传照片",-1)),Ze=["src"],Qe={__name:"avatar-input",props:{value:{type:String,default:""}},emits:["update:value","change"],setup(P,{emit:c}){function O(n){return new Promise((r,d)=>{const o=new FileReader;o.readAsDataURL(n),o.onload=()=>r(o.result),o.onerror=S=>d(S)})}const v=c,I=P,u=y([]),w=y(!1),t=y("");Pe(()=>I.value,n=>{t.value=n},{immediate:!0});const B=N.useInjectFormItemContext(),A=()=>{let n={imageUrl:t.value,file:u.value[0].originFileObj};v("change",n),v("update:value",n.imageUrl),B.onFieldChange()},g=n=>n.type==="image/jpeg"||n.type==="image/png"?n.size/1024<1024?(u.value=[n],O(n).then(o=>{t.value=o,w.value=!1,A()}),!1):(T.error("成员头像图片大小不能超过1M"),!1):(T.error("机器人头像只支持JPG、PNG格式的图片"),!1),b=y(!1),s=y(""),U=y(""),f=()=>{b.value=!1,U.value=""},i=async n=>{!n.url&&!n.preview&&(n.preview=await O(n.originFileObj)),s.value=n.url||n.preview,b.value=!0,U.value=n.name||n.url.substring(n.url.lastIndexOf("/")+1)};return(n,r)=>{const d=Le,o=K;return p(),M("div",Ke,[e(d,{"file-list":u.value,"onUpdate:fileList":r[0]||(r[0]=S=>u.value=S),"list-type":"picture-card","show-upload-list":!1,"before-upload":g,accept:".jpg,.png,.jpeg",onPreview:i},{default:a(()=>[t.value?(p(),M("img",{key:0,class:"avatar",src:t.value,alt:"avatar"},null,8,je)):(p(),M("div",Ve,[w.value?(p(),E(x(ge),{key:0})):(p(),E(x(ee),{key:1})),Ye]))]),_:1},8,["file-list"]),e(o,{open:b.value,title:U.value,footer:null,onCancel:f},{default:a(()=>[m("img",{alt:"example",style:{width:"100%"},src:s.value},null,8,Ze)]),_:1},8,["open","title"])])}}},We=G(Qe,[["__scopeId","data-v-c21fed10"]]),$="data:image/png;base64,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",$e={class:"form-box"},Je={__name:"add-team-members",emits:["ok"],setup(P,{expose:c,emit:O}){const v=O,I=N.useForm,u=y(!1),w=y("添加团队成员"),t=z({user_name:"",nick_name:"",avatar:"",avatar_url:"",user_roles:"3",password:"",check_password:"",id:""}),B=d=>{t.avatar=d.file},A=y([]);ae({page:1,size:200,search:""}).then(d=>{let o=d.data.list||[];A.value=o.filter(S=>S.id!="1")});const g=z({user_name:[{message:"请输入登录账号",required:!0},{validator:async(d,o)=>!/^[a-zA-Z0-9_.-]+$/.test(o)&&o?Promise.reject("账号只能为字母、数字、“-”、“_”,“.”的组合"):Promise.resolve()}],nick_name:[{message:"请输入昵称",required:!0}],avatar_url:[{message:"请上传头像",required:!0}],user_roles:[{message:"请选择成员角色",required:!0}],password:[{message:"请输入登录密码",required:!0},{validator:async(d,o)=>!ue(o)&&o?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(d,o)=>o!=t.password&&o?Promise.reject("两次输入的密码不一致"):Promise.resolve()}]}),{resetFields:b,validate:s,validateInfos:U}=I(t,g),f=()=>{w.value="添加团队成员",u.value=!0,b(),t.user_name="",t.nick_name="",t.avatar="",t.avatar_url=$,t.user_roles="3",t.password="",t.check_password="",t.id=""},i=d=>{w.value="编辑团队成员",t.user_name=d.user_name,t.nick_name=d.nick_name,t.avatar_url=d.avatar||$,t.avatar="",t.user_roles=d.user_roles,t.password="",t.check_password="",t.id=d.id,delete g.password,delete g.check_password,u.value=!0},n=y(!1),r=()=>{s().then(()=>{let d={...re(t)};delete d.avatar_url,n.value=!0,ke(d).then(o=>{T.success(`${w.value}成功`),u.value=!1,v("ok")}).finally(()=>{n.value=!1})})};return c({add:f,edit:i}),(d,o)=>{const S=ie,l=J,h=Me,D=Fe,F=de,Q=N,H=K;return p(),M("div",null,[e(H,{open:u.value,"onUpdate:open":o[6]||(o[6]=C=>u.value=C),title:w.value,onOk:r,width:"476px"},{default:a(()=>[m("div",$e,[e(Q,{layout:"vertical"},{default:a(()=>[e(l,R({label:"登录账号"},x(U).user_name),{default:a(()=>[e(S,{disabled:t.id!="",type:"text",placeholder:"账号只能为字母、数字、“-”、“_”,“.”的组合",value:t.user_name,"onUpdate:value":o[0]||(o[0]=C=>t.user_name=C)},null,8,["disabled","value"])]),_:1},16),e(l,R({label:"成员昵称"},x(U).nick_name),{default:a(()=>[e(S,{maxlength:100,type:"text",placeholder:"请输入昵称",value:t.nick_name,"onUpdate:value":o[1]||(o[1]=C=>t.nick_name=C)},null,8,["value"])]),_:1},16),e(l,{label:"成员头像"},{default:a(()=>[e(We,{value:t.avatar_url,"onUpdate:value":o[2]||(o[2]=C=>t.avatar_url=C),onChange:B},null,8,["value"])]),_:1}),e(l,R({label:"成员角色"},x(U).user_roles),{default:a(()=>[e(D,{value:t.user_roles,"onUpdate:value":o[3]||(o[3]=C=>t.user_roles=C),style:{width:"100%"},placeholder:"请选择成员角色"},{default:a(()=>[(p(!0),M(X,null,q(A.value,C=>(p(),E(h,{key:C.id,value:C.id},{default:a(()=>[L(k(C.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},16),t.id?W("",!0):(p(),E(l,R({key:0,label:"登录密码"},x(U).password),{default:a(()=>[e(F,{value:t.password,"onUpdate:value":o[4]||(o[4]=C=>t.password=C),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16)),t.id?W("",!0):(p(),E(l,R({key:1,label:"确认密码"},x(U).check_password),{default:a(()=>[e(F,{value:t.check_password,"onUpdate:value":o[5]||(o[5]=C=>t.check_password=C),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16))]),_:1})])]),_:1},8,["open","title"])])}}},et=G(Je,[["__scopeId","data-v-ab949f19"]]),tt={class:"form-box"},at={__name:"reset-password",emits:["ok"],setup(P,{expose:c,emit:O}){const v=O,I=N.useForm,u=y(!1),w=y("重置登录密码"),t=z({password:"",check_password:"",id:""}),B=z({password:[{message:"请输入登录密码",required:!0},{validator:async(f,i)=>!ue(i)&&i?Promise.reject("密码必须包含字母、数字或者字符中的两种，6-32位"):Promise.resolve()}],check_password:[{message:"请输入确认密码",required:!0},{validator:async(f,i)=>i!=t.password&&i?Promise.reject("两次输入的密码不一致"):Promise.resolve()}]}),{resetFields:A,validate:g,validateInfos:b}=I(t,B),s=f=>{f.id,u.value=!0,A(),t.password="",t.check_password="",t.id=f.id},U=()=>{g().then(()=>{we({...re(t)}).then(f=>{T.success("修改成功"),u.value=!1,v("ok")})})};return c({open:s}),(f,i)=>{const n=de,r=J,d=N,o=K;return p(),M("div",null,[e(o,{open:u.value,"onUpdate:open":i[2]||(i[2]=S=>u.value=S),title:w.value,onOk:U,width:"476px"},{default:a(()=>[m("div",tt,[e(d,{layout:"vertical"},{default:a(()=>[e(r,R({label:"登录密码"},x(b).password),{default:a(()=>[e(n,{value:t.password,"onUpdate:value":i[0]||(i[0]=S=>t.password=S),placeholder:"密码必须包含字母、数字或者字符中的两种，6-32位"},null,8,["value"])]),_:1},16),e(r,R({label:"确认密码"},x(b).check_password),{default:a(()=>[e(n,{value:t.check_password,"onUpdate:value":i[1]||(i[1]=S=>t.check_password=S),placeholder:"请重新输入密码"},null,8,["value"])]),_:1},16)]),_:1})])]),_:1},8,["open","title"])])}}},st=G(at,[["__scopeId","data-v-8c704fed"]]),ot={class:"team-members-pages"},lt={class:"list-box"},nt={class:"user-box"},rt=["src"],ut={class:"name-info"},it={class:"user-name"},dt={class:"nick-name"},ct=["onClick"],_t=["onClick"],pt=["onClick"],mt={__name:"team-members",setup(P){const c=ye(),{userInfo:O}=Ie(c);Be(()=>O.value.user_roles);const v=z({page:1,size:10,total:0,search:""}),I=f=>{v.page=f.current,v.size=f.pageSize,t()},u=()=>{v.page=1,t()},w=y([]),t=()=>{let f={page:v.page,size:v.size,search:v.search};be(f).then(i=>{let n=i.data.list;n.forEach(r=>{r.login_time=r.login_time>0?_e(r.login_time*1e3).format("YYYY-MM-DD HH:mm"):"--"}),w.value=n,v.total=+i.data.total})};u();const B=y(null),A=()=>{B.value.add()},g=f=>{B.value.edit(f)},b=y(null),s=f=>{b.value.open(f)},U=f=>{K.confirm({title:"提示?",icon:e(se),content:"确认删除该用户",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{Ce({id:f.id}).then(i=>{T.success("删除成功"),t()})},onCancel(){}})};return(f,i)=>{const n=oe,r=ce,d=te,o=pe,S=me;return p(),M("div",ot,[e(d,{justify:"space-between"},{default:a(()=>[e(n,{type:"primary",onClick:A},{icon:a(()=>[e(x(ee))]),default:a(()=>[L(" 添加团队成员 ")]),_:1}),e(r,{value:v.search,"onUpdate:value":i[0]||(i[0]=l=>v.search=l),placeholder:"输入成员账号或昵称搜索",style:{width:"288px"},onSearch:u},null,8,["value"])]),_:1}),m("div",lt,[e(S,{"data-source":w.value,pagination:{current:v.page,total:v.total,pageSize:v.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:I},{default:a(()=>[e(o,{title:"姓名","data-index":"user_name",width:"300px"},{default:a(({record:l})=>[m("div",nt,[m("img",{src:l.avatar||x($),alt:""},null,8,rt),m("div",ut,[m("div",it,k(l.user_name),1),m("div",dt,k(l.nick_name),1)])])]),_:1}),e(o,{title:"角色","data-index":"user_roles",width:"190px"},{default:a(({record:l})=>[L(k(l.role),1)]),_:1}),e(o,{title:"最近登录时间","data-index":"login_time",width:"190px"},{default:a(({record:l})=>[L(k(l.login_time),1)]),_:1}),e(o,{title:"最近登录IP","data-index":"IP",width:"190px"},{default:a(({record:l})=>[L(k(l.login_ip),1)]),_:1}),e(o,{title:"操作","data-index":"action",width:"208px"},{default:a(({record:l})=>[l.user_roles!=1?(p(),E(d,{key:0,gap:16},{default:a(()=>[m("a",{onClick:h=>g(l)},"编辑",8,ct),m("a",{onClick:h=>s(l)},"重置密码",8,_t),m("a",{onClick:h=>U(l)},"移除",8,pt)]),_:2},1024)):W("",!0)]),_:1})]),_:1},8,["data-source","pagination"])]),e(et,{ref_key:"addTeamMembersRef",ref:B,onOk:t},null,512),e(st,{ref_key:"resetPasswordRef",ref:b,onOk:t},null,512)])}}},vt=G(mt,[["__scopeId","data-v-9ca02b8f"]]),Z=P=>(le("data-v-7dd9d4de"),P=P(),ne(),P),ft={class:"form-box"},ht={class:"role-check-box"},gt=Z(()=>m("div",{class:"title-row"},"机器人管理",-1)),kt={class:"check-num"},wt={class:"role-check-box"},yt=Z(()=>m("div",{class:"title-row"},"知识库管理",-1)),bt={class:"check-num"},Ct={class:"role-check-box"},xt=Z(()=>m("div",{class:"title-row"},"系统设置",-1)),At={class:"check-num"},Ut={class:"role-check-box"},Ot=Z(()=>m("div",{class:"title-row"},"客户端管理",-1)),St={class:"check-num"},Pt={__name:"add-role",emits:["ok"],setup(P,{expose:c,emit:O}){const v=O,I=N.useForm;let u=[],w=[],t=[],B=[];xe().then(l=>{u=[{label:l.data[1].name,value:l.data[1].uni_key}],w=[{label:l.data[2].name,value:l.data[2].uni_key}],t=[{label:l.data[3].name,value:l.data[3].uni_key}],B=[{label:l.data[4].name,value:l.data[4].uni_key}]});const A=y(!1),g=y("添加角色"),b=y(""),s=z({name:"",mark:"",robotChecked:[],libraryChecked:[],systemChecked:[],clientChecked:[],role_type:""}),U=z({name:[{message:"请输入角色名称",required:!0}]}),{resetFields:f,validate:i,validateInfos:n}=I(s,U),r=()=>{g.value="添加角色",b.value="",A.value=!0,s.name="",s.mark="",f()},d=l=>{g.value="编辑角色",b.value=l.id,Ae({id:l.id}).then(h=>{let D=h.data,F=D.role_permission||[];s.name=D.name,s.mark=D.mark,s.role_type=D.role_type,s.robotChecked=o(u,F),s.libraryChecked=o(w,F),s.systemChecked=o(t,F),s.clientChecked=o(B,F),A.value=!0})},o=(l,h)=>{let D=[];return l.forEach(F=>{h.includes(F.value)&&D.push(F.value)}),D},S=()=>{i().then(()=>{let l=[...s.robotChecked,...s.libraryChecked,...s.systemChecked,...s.clientChecked],h={id:b.value,name:s.name,mark:s.mark,role_type:s.role_type,uni_keys:l.join(",")};Ue(h).then(D=>{A.value=!1,T.success("保存成功"),v("ok")})})};return c({add:r,edit:d}),(l,h)=>{const D=ie,F=J,Q=De,H=te,C=Ee,j=ze,V=Ge,Y=Re,ve=N,fe=K;return p(),M("div",null,[e(fe,{open:A.value,"onUpdate:open":h[6]||(h[6]=_=>A.value=_),title:g.value,onOk:S,width:"746px"},{default:a(()=>[m("div",ft,[e(ve,{layout:"vertical"},{default:a(()=>[e(F,R({label:"角色名称"},x(n).name),{default:a(()=>[e(D,{type:"text",maxlength:100,placeholder:"请输入角色名称",value:s.name,"onUpdate:value":h[0]||(h[0]=_=>s.name=_)},null,8,["value"])]),_:1},16),e(F,{label:"角色备注"},{default:a(()=>[e(Q,{value:s.mark,"onUpdate:value":h[1]||(h[1]=_=>s.mark=_),placeholder:"请输入知识库介绍"},null,8,["value"])]),_:1}),e(F,{label:"角色权限"},{default:a(()=>[m("div",ht,[e(H,{class:"title-boock",justify:"space-between"},{default:a(()=>[gt,m("div",kt,k(s.robotChecked.length)+"/"+k(x(u).length),1)]),_:1}),e(Y,{value:s.robotChecked,"onUpdate:value":h[2]||(h[2]=_=>s.robotChecked=_),style:{width:"100%"}},{default:a(()=>[e(V,{gutter:[0,12]},{default:a(()=>[(p(!0),M(X,null,q(x(u),_=>(p(),E(j,{span:6,key:_.value},{default:a(()=>[e(C,{value:_.value},{default:a(()=>[L(k(_.label),1)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1})]),_:1},8,["value"])]),m("div",wt,[e(H,{class:"title-boock",justify:"space-between"},{default:a(()=>[yt,m("div",bt,k(s.libraryChecked.length)+"/"+k(x(w).length),1)]),_:1}),e(Y,{value:s.libraryChecked,"onUpdate:value":h[3]||(h[3]=_=>s.libraryChecked=_),style:{width:"100%"}},{default:a(()=>[e(V,{gutter:[0,12]},{default:a(()=>[(p(!0),M(X,null,q(x(w),_=>(p(),E(j,{span:6,key:_.value},{default:a(()=>[e(C,{value:_.value},{default:a(()=>[L(k(_.label),1)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1})]),_:1},8,["value"])]),m("div",Ct,[e(H,{class:"title-boock",justify:"space-between"},{default:a(()=>[xt,m("div",At,k(s.systemChecked.length)+"/"+k(x(t).length),1)]),_:1}),e(Y,{value:s.systemChecked,"onUpdate:value":h[4]||(h[4]=_=>s.systemChecked=_),style:{width:"100%"}},{default:a(()=>[e(V,{gutter:[0,12]},{default:a(()=>[(p(!0),M(X,null,q(x(t),_=>(p(),E(j,{span:6,key:_.value},{default:a(()=>[e(C,{value:_.value},{default:a(()=>[L(k(_.label),1)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1})]),_:1},8,["value"])]),m("div",Ut,[e(H,{class:"title-boock",justify:"space-between"},{default:a(()=>[Ot,m("div",St,k(s.clientChecked.length)+"/"+k(x(B).length),1)]),_:1}),e(Y,{value:s.clientChecked,"onUpdate:value":h[5]||(h[5]=_=>s.clientChecked=_),style:{width:"100%"}},{default:a(()=>[e(V,{gutter:[0,12]},{default:a(()=>[(p(!0),M(X,null,q(x(B),_=>(p(),E(j,{span:6,key:_.value},{default:a(()=>[e(C,{value:_.value},{default:a(()=>[L(k(_.label),1)]),_:2},1032,["value"])]),_:2},1024))),128))]),_:1})]),_:1},8,["value"])])]),_:1})]),_:1})])]),_:1},8,["open","title"])])}}},It=G(Pt,[["__scopeId","data-v-7dd9d4de"]]),Bt={class:"team-members-pages"},Lt={class:"list-box"},Mt={__name:"role-permissions",setup(P){y("");const c=z({page:1,size:10,total:0,search:""}),O=y([{}]),v=g=>{c.page=g.current,c.size=g.pageSize,u()},I=()=>{c.page=1,u()},u=()=>{let g={page:c.page,size:c.size,search:c.search};ae(g).then(b=>{let s=b.data.list;s.forEach(U=>{U.update_time=_e(U.update_time*1e3).format("YYYY-MM-DD HH:mm")}),O.value=s,c.total=+b.data.total})};I();const w=y(null),t=()=>{w.value.add()},B=g=>{w.value.edit(g)},A=g=>{K.confirm({title:"提示?",icon:e(se),content:"确认删除该角色",okText:"确认",okType:"danger",cancelText:"取消",onOk:()=>{Oe({id:g.id}).then(b=>{T.success("删除成功"),u()})},onCancel(){}})};return(g,b)=>{const s=oe,U=ce,f=te,i=pe,n=me;return p(),M("div",Bt,[e(f,{justify:"space-between"},{default:a(()=>[e(s,{type:"primary",onClick:t},{icon:a(()=>[e(x(ee))]),default:a(()=>[L(" 添加角色 ")]),_:1}),e(U,{value:c.search,"onUpdate:value":b[0]||(b[0]=r=>c.search=r),placeholder:"输入角色名称",style:{width:"288px"},onSearch:I},null,8,["value"])]),_:1}),m("div",Lt,[e(n,{"data-source":O.value,pagination:{current:c.page,total:c.total,pageSize:c.size,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"]},onChange:v},{default:a(()=>[e(i,{title:"角色","data-index":"name",width:"157px"},{default:a(({record:r})=>[L(k(r.name),1)]),_:1}),e(i,{title:"备注","data-index":"mark",width:"480px"},{default:a(({record:r})=>[L(k(r.mark),1)]),_:1}),e(i,{title:"最近修改时间","data-index":"update_time",width:"130px"},{default:a(({record:r})=>[L(k(r.update_time),1)]),_:1}),e(i,{title:"最近修改人","data-index":"operate_name",width:"130px"},{default:a(({record:r})=>[L(k(r.operate_name),1)]),_:1}),e(i,{title:"创建人","data-index":"create_name",width:"130px"},{default:a(({record:r})=>[L(k(r.create_name),1)]),_:1}),e(i,{title:"操作","data-index":"action",width:"178px"},{default:a(({record:r})=>[e(f,{gap:16,class:"action-box"},{default:a(()=>[e(s,{type:"link",onClick:d=>B(r),disabled:r.role_type=="1"},{default:a(()=>[L("编辑")]),_:2},1032,["onClick","disabled"]),e(s,{type:"link",onClick:d=>A(r),disabled:r.id<=3},{default:a(()=>[L("删除")]),_:2},1032,["onClick","disabled"])]),_:2},1024)]),_:1})]),_:1},8,["data-source","pagination"])]),e(It,{ref_key:"addRoleRef",ref:w,onOk:u},null,512)])}}},Ft=G(Mt,[["__scopeId","data-v-63005eb7"]]),Dt={class:"user-model-page"},Et={class:"list-wrapper"},Rt={__name:"index",setup(P){const c=y(1),O=()=>{c.value};return(v,I)=>(p(),M("div",Dt,[e(Xe,{value:c.value,"onUpdate:value":I[0]||(I[0]=u=>c.value=u),onChange:O},null,8,["value"]),m("div",Et,[c.value==1?(p(),E(vt,{key:0})):(p(),E(Ft,{key:1}))])]))}},wa=G(Rt,[["__scopeId","data-v-df6b3107"]]);export{wa as default};
