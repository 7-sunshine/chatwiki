import{e as De,b as D,r as y,w as Fe,j as n,F as R,L as d,M as g,V as o,Q as u,u as J,a3 as ae,a4 as se,ag as xe,X as E,Y as P,a1 as oe,a7 as fe,a8 as B,E as ke,a0 as Oe,A as Me,$ as je,a5 as Te,P as V}from"./vue-chunks-XeeYQ2kA.js";import{Z as Be,bm as Re,$ as Ue,W as ne,aX as Ve,a4 as he,bn as re,a9 as ge,Y as be,ar as Ne,A as He,_ as Y,B as qe,M as ce,E as Qe,d as G,c as Ge}from"../../index-pGVpQMA0.js";import{P as Ie}from"./PlusOutlined-BvMptCf7.js";import{n as We,o as Ke,p as Je,b as Xe,q as Ye}from"./index-DRYFeHdL.js";import{C as ie}from"./cu-scroll-C9Z-NGE0.js";import{U as Ze}from"./index-BmILeX8V.js";import"./index-BPzZ8HYg.js";import{I as et}from"./Input-BpoOlxnx.js";import{_ as tt,T as nt}from"./index-BBKzoe5I.js";import{_ as ot}from"./TextArea-DvqYUUpc.js";import{_ as at}from"./index-zLXV6DVR.js";import{u as st,_ as lt,F as it}from"./index-BlZhlPki.js";import{S as rt,_ as ct}from"./index-CpXIlpHQ.js";import{B as ut,_ as dt}from"./index-BgRQl0SV.js";import{D as _t}from"./DownOutlined-C8Q6Kr-5.js";import{_ as pt,M as vt}from"./index-Cxpqycif.js";import"./index-DkJY3DLr.js";import{D as mt}from"./dropdown-CkB_t3kv.js";import{S as ft}from"./index-DwwRbEJn.js";import{L as ht}from"./LeftOutlined-CO6JLRKk.js";import"./dayjs-oAino27R.js";import"./axios-Cm0UX6qg.js";import"./qs-DfimNey5.js";import"./crypto-js-CuiFEUvY.js";import"./index-C1dDnJdU.js";import"./Password-BTEAOcTM.js";import"./inputProps-DZRcc7xF.js";import"./index-CzGOUy8a.js";import"./colors-DCZEizLq.js";import"./CheckOutlined-_VUPY4GZ.js";import"./useRefs-DGVWkBGy.js";import"./collapseMotion-Bep1tU8X.js";import"./FormItemContext-Da_jkx0v.js";import"./index-Z11VoXTE.js";import"./Search-CpOmfbSY.js";import"./SearchOutlined-C_Q6hh1x.js";import"./Dropdown-CcwauEi-.js";import"./index-Bruf23Oc.js";import"./slide-D6W0LxJh.js";import"./responsiveObserve-Cdlm3rJ_.js";import"./QuestionCircleOutlined-C6hYQFmR.js";import"./move-jqhYINnj.js";import"./shallowequal-Da0otATl.js";import"./RightOutlined-DJ2Olgkf.js";const gt={small:8,middle:16,large:24},bt=()=>({prefixCls:String,size:{type:[String,Number,Array]},direction:ge.oneOf(be("horizontal","vertical")).def("horizontal"),align:ge.oneOf(be("start","end","center","baseline")),wrap:Ne()});function yt(e){return typeof e=="string"?gt[e]:e||0}const X=De({compatConfig:{MODE:3},name:"ASpace",inheritAttrs:!1,props:bt(),slots:Object,setup(e,a){let{slots:t,attrs:r}=a;const{prefixCls:l,space:v,direction:m}=Be("space",e),[q,_]=Re(l),S=st(),b=D(()=>{var s,p,O;return(O=(s=e.size)!==null&&s!==void 0?s:(p=v==null?void 0:v.value)===null||p===void 0?void 0:p.size)!==null&&O!==void 0?O:"small"}),i=y(),$=y();Fe(b,()=>{[i.value,$.value]=(Array.isArray(b.value)?b.value:[b.value,b.value]).map(s=>yt(s))},{immediate:!0});const k=D(()=>e.align===void 0&&e.direction==="horizontal"?"center":e.align),C=D(()=>Ue(l.value,_.value,`${l.value}-${e.direction}`,{[`${l.value}-rtl`]:m.value==="rtl",[`${l.value}-align-${k.value}`]:k.value})),I=D(()=>m.value==="rtl"?"marginLeft":"marginRight"),L=D(()=>{const s={};return S.value&&(s.columnGap=`${i.value}px`,s.rowGap=`${$.value}px`),ne(ne({},s),e.wrap&&{flexWrap:"wrap",marginBottom:`${-$.value}px`})});return()=>{var s,p;const{wrap:O,direction:z="horizontal"}=e,M=(s=t.default)===null||s===void 0?void 0:s.call(t),j=Ve(M),N=j.length;if(N===0)return null;const F=(p=t.split)===null||p===void 0?void 0:p.call(t),w=`${l.value}-item`,T=i.value,H=N-1;return n("div",he(he({},r),{},{class:[C.value,r.class],style:[L.value,r.style]}),[j.map((ee,Q)=>{let c=M.indexOf(ee);c===-1&&(c=`$$space-${Q}`);let f={};return S.value||(z==="vertical"?Q<H&&(f={marginBottom:`${T/(F?2:1)}px`}):f=ne(ne({},Q<H&&{[I.value]:`${T/(F?2:1)}px`}),O&&{paddingBottom:`${$.value}px`})),q(n(R,{key:c},[n("div",{class:w,style:f},[ee]),Q<H&&F&&n("span",{class:`${w}-split`,style:f},[F])]))})])}}});X.Compact=re;X.install=function(e){return e.component(X.name,X),e.component(re.name,re),e};const $t=X;var St={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 009.3-35.2l-.9-2.6a443.74 443.74 0 00-79.7-137.9l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.4a351.86 351.86 0 00-99 57.4l-81.9-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a446.02 446.02 0 00-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0025.8 25.7l2.7.5a449.4 449.4 0 00159 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-85a350 350 0 0099.7-57.6l81.3 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9a370.03 370.03 0 01-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97a377.5 377.5 0 01-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 01624 502c0 29.9-11.7 58-32.8 79.2z"}}]},name:"setting",theme:"outlined"};const wt=St;function ye(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?Object(arguments[a]):{},r=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable}))),r.forEach(function(l){xt(e,l,t[l])})}return e}function xt(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var ue=function(a,t){var r=ye({},a,t.attrs);return n(He,ye({},r,{icon:wt}),null)};ue.displayName="SettingOutlined";ue.inheritAttrs=!1;const kt=ue,Ot="/assets/img/empty-oK82-lgD.png",de=e=>(ae("data-v-16e77398"),e=e(),se(),e),qt={class:"empty-box"},It=de(()=>o("img",{src:Ot,alt:""},null,-1)),Pt=de(()=>o("div",{class:"title"},"知识库文档为空，请添加分段",-1)),Et=de(()=>o("span",null,"添加分段",-1)),Ct={__name:"empty",props:{detailsInfo:{type:Object}},emits:["openEditSubscription"],setup(e,{emit:a}){const t=a,r=()=>{t("openEditSubscription",{})};return(l,v)=>{const m=qe;return d(),g("div",qt,[It,Pt,o("div",null,[n(m,{type:"primary",onClick:r},{icon:u(()=>[n(J(Ie))]),default:u(()=>[Et]),_:1})])])}}},$e=Y(Ct,[["__scopeId","data-v-16e77398"]]),At=e=>(ae("data-v-cdb41e8b"),e=e(),se(),e),Lt={class:"subsection-box"},zt={class:"subsection-box-title"},Dt=["onClick"],Ft={class:"top-block"},Mt={class:"title"},jt={class:"right-opration"},Tt=["onClick"],Bt=At(()=>o("span",{class:"v-line"},null,-1)),Rt=["onClick"],Ut={key:0,class:"content-box"},Vt={key:1,class:"content-box"},Nt=["innerHTML"],Ht={class:"fragment-img"},Qt=["src"],Gt={__name:"subsection-box",props:{paragraphLists:{type:Array,default:()=>[]},total:{type:[Number,String],default:0}},emits:["handleDelParagraph","handleScrollTargetPage","openEditSubscription"],setup(e,{expose:a,emit:t}){const r=t,l=e,v=_=>{r("openEditSubscription",_)},m=_=>{ce.confirm({title:"提示",icon:n(Qe),content:"确认是否删除该分段?",onOk(){return new Promise((S,b)=>{We({id:_}).then(i=>{G.success("删除成功"),r("handleDelParagraph",_),S()}).catch(()=>{S()})})},onCancel(){}})},q=_=>{r("handleScrollTargetPage",_)};return a({handleOpenEditModal:v}),(_,S)=>{const b=xe("viewer");return d(),g("div",Lt,[o("div",zt,[E(" 分段预览 "),o("span",null,"共"+P(l.total)+"个分段",1)]),(d(!0),g(R,null,oe(l.paragraphLists,i=>(d(),g("div",{onClick:$=>q(i.page_num),class:"list-item",key:i.id},[o("div",Ft,[o("div",Mt,[E(" id："+P(i.id)+" "+P(i.title)+" ",1),o("span",null,"共"+P(i.word_total)+"个字符",1),o("span",null,"状态："+P(i.status_text),1)]),o("div",jt,[o("a",{onClick:fe($=>v(i),["stop"])},"编辑",8,Tt),Bt,o("a",{onClick:fe($=>m(i.id),["stop"])},"删除",8,Rt)])]),i.question?(d(),g("div",Ut,"Q："+P(i.question),1)):B("",!0),i.answer?(d(),g("div",Vt,"A："+P(i.answer),1)):B("",!0),o("div",{class:"content-box",innerHTML:i.content},null,8,Nt),ke((d(),g("div",Ht,[(d(!0),g(R,null,oe(i.images,($,k)=>(d(),g("img",{key:k,src:$,alt:""},null,8,Qt))),128))])),[[b]])],8,Dt))),128))])}}},Se=Y(Gt,[["__scopeId","data-v-cdb41e8b"]]);var h={},_e;Object.defineProperty(h,"__esModule",{value:!0});h.controlDefaultValue=h.capitalize=h.camelize=h.cacheStringFunction=void 0;h.getDataAndAriaProps=on;h.isSymbol=h.isString=h.isOn=h.isObject=h.isFunction=_e=h.isArray=h.hyphenate=void 0;h.renderHelper=sn;h.resolvePropValue=nn;h.toPx=an;h.wrapPromiseFn=ln;const Pe=e=>typeof e=="function";h.isFunction=Pe;h.controlDefaultValue=Symbol("controlDefaultValue");_e=h.isArray=Array.isArray;const Wt=e=>typeof e=="string";h.isString=Wt;const Kt=e=>typeof e=="symbol";h.isSymbol=Kt;const Jt=e=>e!==null&&typeof e=="object";h.isObject=Jt;const Xt=/^on[^a-z]/,Yt=e=>Xt.test(e);h.isOn=Yt;const le=e=>{const a=Object.create(null);return t=>a[t]||(a[t]=e(t))};h.cacheStringFunction=le;const Zt=/-(\w)/g;h.camelize=le(e=>e.replace(Zt,(a,t)=>t?t.toUpperCase():""));const en=/\B([A-Z])/g;h.hyphenate=le(e=>e.replace(en,"-$1").toLowerCase());h.capitalize=le(e=>e.charAt(0).toUpperCase()+e.slice(1));const tn=Object.prototype.hasOwnProperty,we=(e,a)=>tn.call(e,a);function nn(e,a,t,r){const l=e[t];if(l!=null){const v=we(l,"default");if(v&&r===void 0){const m=l.default;r=l.type!==Function&&Pe(m)?m():m}l.type===Boolean&&(!we(a,t)&&!v?r=!1:r===""&&(r=!0))}return r}function on(e){return Object.keys(e).reduce((a,t)=>((t.startsWith("data-")||t.startsWith("aria-"))&&(a[t]=e[t]),a),{})}function an(e){return typeof e=="number"?`${e}px`:e}function sn(e){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0;return typeof e=="function"?e(a):e??t}function ln(e){let a;const t=new Promise(l=>{a=e(()=>{l(!0)})}),r=()=>{a==null||a()};return r.then=(l,v)=>t.then(l,v),r.promise=t,r}const Z=e=>(ae("data-v-bc21f471"),e=e(),se(),e),rn={class:"form-box-wrapper"},cn={class:"form-item"},un=Z(()=>o("div",{class:"form-label"},"分段标题：",-1)),dn={class:"form-content"},_n={class:"form-item"},pn=Z(()=>o("div",{class:"form-label required"},"分段问题：",-1)),vn={class:"form-content"},mn={class:"form-item"},fn=Z(()=>o("div",{class:"form-label required"},"分段答案：",-1)),hn={class:"form-content"},gn={key:1,class:"form-item"},bn=Z(()=>o("div",{class:"form-label required"},"分段内容：",-1)),yn={class:"form-content"},$n={class:"form-item"},Sn=Z(()=>o("div",{class:"form-label"},"附件",-1)),wn={class:"form-content"},xn={class:"upload-box-wrapper"},kn={key:0},On={__name:"edit-subsection",props:{detailsInfo:{type:Object}},emits:["handleEdit"],setup(e,{expose:a,emit:t}){const r=Oe(),l=e,v=t,m=y("1"),q=y(!1),_=y(""),S=y(""),b=y(""),i=y(""),$=y([]),k=y(""),C=y(!1),I=s=>{_.value=s.title||"",S.value=s.content||"",k.value=s.id||"",b.value=s.answer||"",$.value=s.images||[],i.value=s.question||"",C.value=l.detailsInfo.is_qa_doc=="1",q.value=!0},L=()=>{if(!S.value&&!C.value)return G.error("请输入分段内容");if(!i.value&&C.value)return G.error("请输入分段问题");if(!b.value&&C.value)return G.error("请输入分段答案");let s={title:_.value,content:S.value,question:i.value,answer:b.value,images:$.value};k.value?s.id=k.value:s.file_id=r.query.id;let p=new FormData;for(let O in s)_e(s[O])?s[O].forEach(z=>{p.append(O,z)}):p.append(O,s[O]);Ke(p).then(O=>{G.success(s.id?"修改成功":"添加成功"),q.value=!1,v("handleEdit",{...s})})};return a({showModal:I}),(s,p)=>{const O=et,z=ot,M=Ge,j=tt,N=nt,F=ce;return d(),g("div",null,[n(F,{open:q.value,"onUpdate:open":p[6]||(p[6]=w=>q.value=w),title:"编辑分段",onOk:L,width:"746px"},{default:u(()=>[o("div",rn,[o("div",cn,[un,o("div",dn,[n(O,{value:_.value,"onUpdate:value":p[0]||(p[0]=w=>_.value=w),placeholder:"请输入分段标题"},null,8,["value"])])]),C.value?(d(),g(R,{key:0},[o("div",_n,[pn,o("div",vn,[n(z,{placeholder:"请输入分段问题",value:i.value,"onUpdate:value":p[1]||(p[1]=w=>i.value=w),style:{height:"100px"}},null,8,["value"])])]),o("div",mn,[fn,o("div",hn,[n(z,{placeholder:"请输入分段答案",value:b.value,"onUpdate:value":p[2]||(p[2]=w=>b.value=w),style:{height:"150px"}},null,8,["value"])])])],64)):(d(),g("div",gn,[bn,o("div",yn,[n(z,{style:{height:"150px"},value:S.value,"onUpdate:value":p[3]||(p[3]=w=>S.value=w),placeholder:"请输入分段内容"},null,8,["value"])])])),o("div",$n,[Sn,o("div",wn,[o("div",xn,[n(N,{activeKey:m.value,"onUpdate:activeKey":p[4]||(p[4]=w=>m.value=w),size:"small"},{default:u(()=>[n(j,{key:"1"},{tab:u(()=>[o("span",null,[n(M,{name:"img-icon",style:{"font-size":"14px",color:"#2475fc"}}),E(" 图片 "),$.value.length?(d(),g("span",kn,"("+P($.value.length)+")",1)):B("",!0)])]),_:1})]),_:1},8,["activeKey"]),n(Ze,{value:$.value,"onUpdate:value":p[5]||(p[5]=w=>$.value=w)},null,8,["value"])])])])])]),_:1},8,["open"])])}}},qn=Y(On,[["__scopeId","data-v-bc21f471"]]),In={class:"mode-box"},Pn=["innerHTML"],En={class:"tag-item"},Cn={__name:"segmentation-mode",props:{detailsInfo:{type:Object}},setup(e){const a=e,t=y(""),r=D(()=>{const{is_table_file:l,is_qa_doc:v,is_diy_split:m,question_lable:q,answer_lable:_,separators:S,chunk_size:b,chunk_overlap:i,question_column:$,answer_column:k,qa_index_type:C,doc_type:I}=a.detailsInfo;if(l!=1&&v!=1&&m!=1)return I==3?(t.value=`分段模式：手动分段
文档类型：普通文档`,"自定义：普通文档"):(t.value=`分段模式：智能分段
文档类型：普通文档`,"智能分段：普通文档");if(l!=1&&v==1)return I==3?(t.value=`分段模式：手动分段
文档类型：QA文档`,"自定义：QA文档"):(t.value=`分段模式：智能分段
文档类型：QA文档
问题开始标识符："${q}"
答案开始标识符："${_}"`,"智能分段：QA文档");if(l!=1&&v!=1&&m==1)return t.value=`分段模式：自定义分段
文档标识符：${S}
分段最大长度：${b}字符
文段重叠长度：${i}字符`,"自定义分段";if(l==1&&v!=1)return t.value=`分段模式：智能分段
文档类型：普通表格`,"智能分段：普通表格";if(l==1&&v==1){let L=C==1?"问题与答案一起生成索引":"仅对问题生成索引";return t.value=`分段模式：智能分段
文档类型：QA文档
问题所在列："${$}"
答案所在列："${k}"
索引方式：${L}`,"智能分段：QA文档"}});return(l,v)=>{const m=at;return d(),g("div",In,[n(m,null,{title:u(()=>[o("div",{class:"tooltip-text-box",innerHTML:t.value},null,8,Pn)]),default:u(()=>[o("div",En,P(r.value),1)]),_:1})])}}},An=Y(Cn,[["__scopeId","data-v-6ee0b31f"]]),Ln={__name:"update-frequency",emits:["ok"],setup(e,{expose:a,emit:t}){const r=t,l=y(!1),v=y(!1),m=Me({doc_auto_renew_frequency:1,id:""}),q=S=>{let{doc_auto_renew_frequency:b,id:i}=S;m.doc_auto_renew_frequency=+b,m.id=i,l.value=!0},_=()=>{v.value=!0,Je({...m}).then(S=>{r("ok",m.doc_auto_renew_frequency),l.value=!1,G.success("设置成功")}).finally(()=>{v.value=!1})};return a({open:q}),(S,b)=>{const i=rt,$=ct,k=lt,C=it,I=ce;return d(),g("div",null,[n(I,{open:l.value,"onUpdate:open":b[1]||(b[1]=L=>l.value=L),"confirm-loading":v.value,maskClosable:!1,title:"设置更新频率",onOk:_},{default:u(()=>[n(C,{style:{margin:"32px 0"},layout:"vertical",model:m},{default:u(()=>[n(k,{name:"doc_auto_renew_frequency",label:"更新频率",required:""},{default:u(()=>[n($,{value:m.doc_auto_renew_frequency,"onUpdate:value":b[0]||(b[0]=L=>m.doc_auto_renew_frequency=L),style:{width:"100%"}},{default:u(()=>[n(i,{value:1},{default:u(()=>[E("不自动更新")]),_:1}),n(i,{value:2},{default:u(()=>[E("每天")]),_:1}),n(i,{value:3},{default:u(()=>[E("每3天")]),_:1}),n(i,{value:4},{default:u(()=>[E("每7天")]),_:1}),n(i,{value:5},{default:u(()=>[E("每30天")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","confirm-loading"])])}}},zn=e=>(ae("data-v-2ec0df89"),e=e(),se(),e),Dn={class:"library-preview-page"},Fn={class:"breadcrumb-block"},Mn={class:"document-title-block"},jn={class:"title"},Tn=zn(()=>o("span",null,"添加分段",-1)),Bn={key:0,class:"page-loading-box"},Rn={class:"content-block"},Un={key:1,class:"pdf-view-box"},Vn={class:"view-content-wrap"},Nn={class:"view-content-box"},Hn=["onClick"],Qn={key:0,class:"content-box"},Gn={key:1,class:"content-box"},Wn=["innerHTML"],Kn={class:"fragment-img"},Jn=["src"],Xn={class:"right-contnt-box"},Yn={class:"content-block"},Zn={__name:"library-preview",setup(e){const a=y({fade:!1,scrollbarTrackClickable:!0,interactive:!0}),t=Oe(),r=je(),l=D(()=>_.value.is_table_file=="1"),v=D(()=>_.value.doc_type),m=D(()=>{let c=_.value.status;return!(c=="1"||c=="2")||s.value.length==0}),q=D(()=>_.value.status),_=y({}),S=()=>{r.back()},b=y(null);let i=-1;const $=c=>{let f=document.querySelectorAll(".subsection-box .list-item")[c];f.classList.add("flash-border"),i>=0&&document.querySelectorAll(".subsection-box .list-item")[i].classList.remove("flash-border"),setTimeout(()=>{i=-1,f.classList.remove("flash-border")},2500),i=c,b.value.scrollToElement({el:f,time:1e3})},k=y(!0);(async()=>{Xe({id:t.query.id}).then(c=>{_.value=c.data;let f=c.data.status;f==1||f==2?M():k.value=!1})})();const I=y({page:1,size:10}),L=y({}),s=y([]),p=y(0),O={0:"未转换",1:"已转换",2:"转换异常"};let z=!0;const M=()=>{z=!0,Ye({file_id:t.query.id,...I.value}).then(c=>{var te,W;k.value=!1,z=!1;let f=c.data,A=f.list||[],x=((te=f.info)==null?void 0:te.is_qa_doc)=="1"&&((W=f.info)==null?void 0:W.is_table_file)=="1";A.forEach(K=>{K.status_text=O[K.status],K.isExcelQa=x}),L.value=f.info,I.value.page==1&&(s.value=[]),s.value=[...s.value,...A],p.value=f.total})},j=()=>{z||s.value.length>=p.value||(I.value.page++,M())},N=c=>{if(!c.id){I.value.page=1,M();return}let f=s.value,A=f.findIndex(x=>x.id==c.id);if(A>-1){let x=f[A];x.title=c.title,x.content=c.content,x.question=c.question,x.answer=c.answer,x.answer=c.answer,x.images=c.images,x.word_total=c.question.length+c.answer.length+c.content.length,f.splice(A,1,x),s.value=f}},F=c=>{let f=s.value,A=f.findIndex(x=>x.id==c);A>-1&&(f.splice(A,1),s.value=f,p.value=p.value--)};y(!0);const w=y(null),T=c=>{w.value.showModal(JSON.parse(JSON.stringify(c)))},H=y(null),ee=c=>{c.key==1&&r.push("/library/document-segmentation?document_id="+t.query.id+"&source=preview"),c.key==2&&H.value.open({id:t.query.id,doc_auto_renew_frequency:_.value.doc_auto_renew_frequency})},Q=c=>{_.value.doc_auto_renew_frequency=c};return(c,f)=>{const A=Te("router-link"),x=dt,te=ut,W=pt,K=vt,pe=qe,Ee=mt,Ce=$t,Ae=ft,Le=xe("viewer");return d(),g("div",Dn,[o("div",Fn,[n(te,null,{default:u(()=>[n(x,null,{default:u(()=>[n(A,{to:"/library/list"},{default:u(()=>[E(" 知识库管理 ")]),_:1})]),_:1}),n(x,null,{default:u(()=>[n(A,{to:{path:"/library/details/knowledge-document",query:{id:_.value.library_id}}},{default:u(()=>[E(P(_.value.library_name)+"知识库",1)]),_:1},8,["to"])]),_:1}),n(x,null,{default:u(()=>[E("知识库详情")]),_:1})]),_:1})]),o("div",Mn,[n(J(ht),{onClick:S}),o("span",jn,P(_.value.file_name),1),n(An,{detailsInfo:_.value},null,8,["detailsInfo"]),n(Ce,{style:{"margin-left":"auto"}},{default:u(()=>[(q.value==2||v.value==2)&&v.value!=3?(d(),V(Ee,{key:0},{overlay:u(()=>[n(K,{onClick:ee},{default:u(()=>[q.value==2?(d(),V(W,{key:"1"},{default:u(()=>[E("重新分段")]),_:1})):B("",!0),v.value==2?(d(),V(W,{key:"2"},{default:u(()=>[E("设置更新频率")]),_:1})):B("",!0)]),_:1})]),default:u(()=>[n(pe,null,{icon:u(()=>[n(J(kt))]),default:u(()=>[n(J(_t))]),_:1})]),_:1})):B("",!0),n(pe,{onClick:f[0]||(f[0]=U=>T({})),type:"primary"},{icon:u(()=>[n(J(Ie))]),default:u(()=>[Tn]),_:1})]),_:1})]),k.value?(d(),g("div",Bn,[n(Ae)])):(d(),g(R,{key:1},[l.value||v.value==3?(d(),g(R,{key:0},[m.value?(d(),V($e,{key:0,onOpenEditSubscription:T})):(d(),V(ie,{key:1,scrollbar:{minSize:0},onOnScrollEnd:j},{default:u(()=>[o("div",Rn,[n(Se,{ref:"subsectionBoxRef",total:p.value,paragraphLists:s.value,detailsInfo:_.value,onOpenEditSubscription:T,onHandleDelParagraph:F},null,8,["total","paragraphLists","detailsInfo"])])]),_:1}))],64)):(d(),g("div",Un,[o("div",Vn,[n(ie,{scrollbar:a.value,class:"scroll-box",onOnScrollEnd:j},{default:u(()=>[o("div",Nn,[(d(!0),g(R,null,oe(s.value,(U,ve)=>(d(),g("div",{class:"list-item",onClick:me=>$(ve),key:ve},[U.question?(d(),g("div",Qn,P(U.question),1)):B("",!0),U.answer?(d(),g("div",Gn,P(U.answer),1)):B("",!0),o("div",{class:"content-box",innerHTML:U.content},null,8,Wn),ke((d(),g("div",Kn,[(d(!0),g(R,null,oe(U.images,(me,ze)=>(d(),g("img",{key:ze,src:me,alt:""},null,8,Jn))),128))])),[[Le]])],8,Hn))),128))])]),_:1},8,["scrollbar"])]),o("div",Xn,[m.value?(d(),V($e,{key:0,onOpenEditSubscription:T})):(d(),V(ie,{key:1,scrollbar:a.value,ref_key:"rightScrollRef",ref:b,onOnScrollEnd:j},{default:u(()=>[o("div",Yn,[n(Se,{ref:"subsectionBoxRef",total:p.value,detailsInfo:_.value,paragraphLists:s.value,onOpenEditSubscription:T,onHandleDelParagraph:F},null,8,["total","detailsInfo","paragraphLists"])])]),_:1},8,["scrollbar"]))])]))],64)),n(qn,{detailsInfo:_.value,onHandleEdit:N,ref_key:"editSubscriptionRef",ref:w},null,8,["detailsInfo"]),n(Ln,{onOk:Q,ref_key:"updateFrequencyRef",ref:H},null,512)])}}},Ho=Y(Zn,[["__scopeId","data-v-2ec0df89"]]);export{Ho as default};
