import{_ as z,b as J,B as ae,d as Z,M as ee,E as ie}from"../../index-QYI4dmfl.js";import{a as re,e as ce,g as me,d as _e}from"./index-Cdvdq_Hq.js";import{r as S,L as t,M as m,F as K,a1 as U,a2 as se,Y as g,u as C,V as i,j as A,ab as ue,Q as c,X as L,a8 as E,E as pe,G as fe,P as M,a9 as R,a3 as ve,a4 as ye,A as de,ac as ge,U as he,ad as ke,b as oe}from"./vue-chunks-BakLQ6XW.js";import{_ as we}from"./index-CTPYdmLs.js";import{F as te,_ as xe}from"./index-3DXu9bgV.js";import"./index-Bp2uqmZD.js";import{R as be,_ as Ie}from"./RadioButton-Bv53M9vz.js";import{S as Ce,_ as Ae}from"./index-BQshy17R.js";import"./index-NUjtZLqN.js";import{I as Me}from"./Input-B-m7eF7I.js";import{_ as Ke}from"./index-T1vVSDTy.js";import{_ as Te,a as $e}from"./index-BZjOIwSp.js";import"./dayjs--xR4C_bb.js";import"./axios-Cm0UX6qg.js";import"./qs-nPXSgJGS.js";import"./crypto-js-KGFlroD9.js";import"./colors-DFPXDQoC.js";import"./responsiveObserve-DyMgoyhx.js";import"./collapseMotion-0mJ0KE5h.js";import"./QuestionCircleOutlined-C2pUlNX4.js";import"./FormItemContext-DfXg-vvi.js";import"./index-B-KPxHLb.js";import"./slide-C7fB9ZqY.js";import"./index-DvsTPK3W.js";import"./CheckOutlined-aV9VsruP.js";import"./DownOutlined-CGvBXkZN.js";import"./SearchOutlined-Xteprsdp.js";import"./move-CXLiHXAi.js";import"./Search-DVHH1l3S.js";import"./inputProps-CY0nAgGz.js";import"./TextArea-BInVhD59.js";import"./Password-DZ8X6uZ4.js";import"./index-DgZB7nBk.js";import"./LeftOutlined-Cmy17bEx.js";import"./RightOutlined-Cd68P3tJ.js";import"./index-BjfQ5M57.js";import"./index-B_MMLMOx.js";import"./dropdown-CILlEKJC.js";import"./Dropdown-w3dDSh2I.js";import"./index-CUqhTkNL.js";import"./shallowequal-q0YU5nsK.js";const Se={class:"page-tabs"},Ee=["onClick"],Be={__name:"page-tabs",props:{value:{type:[Number,String]}},emits:["update:value","change"],setup(a,{emit:_}){const{t:s}=J(),d=_,w=a,u=S([{value:1,title:s("views.user.model.modelsHaveBeenAdded"),langKey:"views.user.model.modelsHaveBeenAdded"},{value:0,title:s("views.user.model.canAddAModel"),langKey:"views.user.model.canAddAModel"}]),$=r=>{d("update:value",r),d("change",r)};return(r,h)=>(t(),m("div",Se,[(t(!0),m(K,null,U(u.value,k=>(t(),m("div",{class:se(["tab-item",{active:w.value==k.value}]),onClick:p=>$(k.value),key:k.value},g(C(s)(k.langKey)),11,Ee))),128))]))}},Le=z(Be,[["__scopeId","data-v-5999ba44"]]),Oe=a=>(ve("data-v-28f26ae3"),a=a(),ye(),a),De={class:"model-list"},Pe={class:"model-item-left"},Re={class:"model-item-left-top"},Ne=["src"],Ue={class:"model-name"},qe=Oe(()=>i("div",{class:"line"},null,-1)),Ve={class:"model-tags"},Fe={key:0,class:"tag"},ze={class:"model-item-left-bottom"},Je={class:"model-desc"},Xe={class:"model-item-right"},Ge={__name:"model-list",props:{type:{type:Number,default:()=>1},list:{type:Array,default:()=>[]}},emits:["edit","new","see","remove","add"],setup(a,{emit:_}){const{t:s}=J(),d=_,w=["azure","ollama","xinference","openaiAgent"],u=a,$=v=>{d("see",R(v))},r=v=>{let y=R(v);d("edit",y,y.config_list[0])},h=v=>{d("new",R(v))},k=v=>{d("add",R(v))},p=v=>{let y=R(v);d("remove",y.config_list[0])};return(v,y)=>{const N=we,f=ae;return t(),m("div",De,[(t(!0),m(K,null,U(u.list,l=>(t(),m("div",{class:"model-item",key:l.model_define},[i("div",Pe,[i("div",Re,[i("img",{class:"model-logo",src:l.model_icon_url,alt:""},null,8,Ne),i("div",Ue,g(l.model_name),1),qe,i("div",Ve,[(t(!0),m(K,null,U(l.support_list,(o,x)=>(t(),m("div",{key:x},[A(N,null,ue({default:c(()=>[o!="SPEECH2TEXT"&&o!="TTS"?(t(),m("span",Fe,g(o),1)):E("",!0)]),_:2},[o=="LLM"?{name:"title",fn:c(()=>[L("大语言模型，添加机器人时需要选择一个大语言模型。用户的提问将交由大语言模型，结合知识库给出答案。")]),key:"0"}:o=="TEXT EMBEDDING"?{name:"title",fn:c(()=>[L("嵌入模型，添加知识库时需要选择嵌入模型，用于将知识库分段向量化。用户提问时也会将问题生成向量，通过比对向量相似度的方式四配跟提问语义相近的知识库分段。向量检索具备很好的语义分析能力。")]),key:"1"}:o=="RERANK"?{name:"title",fn:c(()=>[L("重排序模型,通过重排序模型,将从知识库中检索出来的分段进行重新排序。再将重排序的结果前top-K传递个大语言模型生成答案。重排序有助于优化检索结果，提高大语言模型回答的准确性。")]),key:"2"}:void 0]),1024)]))),128))])]),i("div",ze,[i("div",Je,g(l.introduce),1)])]),i("div",Xe,[pe(A(f,{class:se({"btn-red":l.listType==1&&u.type==1}),onClick:o=>p(l)},{default:c(()=>[L(g(l.listType==1&&u.type==1?"移除配置":"删除"),1)]),_:2},1032,["class","onClick"]),[[fe,u.type==1]]),u.type==2&&l.model_define!="azure"?(t(),M(f,{key:0,class:"add-btn",onClick:o=>$(l)},{default:c(()=>[L("查看模型")]),_:2},1032,["onClick"])):E("",!0),u.type==2?(t(),M(f,{key:1,disabled:l.listType==1,class:"add-btn",onClick:o=>k(l)},{default:c(()=>[L("添加配置")]),_:2},1032,["disabled","onClick"])):E("",!0),l.listType==1&&u.type==1?(t(),m(K,{key:2},[w.indexOf(l.model_define)>-1?(t(),m(K,{key:0},[A(f,{class:"add-btn",onClick:o=>$(l)},{default:c(()=>[L(g(C(s)("views.user.model.modelConfigButton"))+"（"+g(l.config_list.length)+"）",1)]),_:2},1032,["onClick"]),A(f,{class:"add-btn",onClick:o=>h(l)},{default:c(()=>[L(g(C(s)("views.user.model.addModelButton")),1)]),_:2},1032,["onClick"])],64)):(t(),m(K,{key:1},[A(f,{class:"add-btn",onClick:o=>r(l)},{default:c(()=>[L(g(C(s)("views.user.model.editModelButton")),1)]),_:2},1032,["onClick"]),A(f,{class:"add-btn",onClick:o=>$(l)},{default:c(()=>[L(g(C(s)("views.user.model.viewModelButton")),1)]),_:2},1032,["onClick"])],64))],64)):E("",!0)])]))),128))])}}},le=z(Ge,[["__scopeId","data-v-28f26ae3"]]),D={componentType:"input",placeholder:"",defaultValue:""},He={componentType:"radio",defaultValue:void 0},je={componentType:"select",defaultValue:void 0},ne={id:{hidden:!0},model_types:{...He,key:"model_types",label:"模型类型",optionsKey:"supported_type",options:[],disabled:!1,rules:[{required:!0,message:"请选择模型类型",trigger:"change"}]},deployment_name:{...D,label:"部署名称",placeholder:"请与Azure 部署名称保持一致",rules:[{required:!0,message:"请输入部署名称",trigger:"change"}]},model_name:{...D,label:"模型名称",placeholder:"模型名称请保持一致",rules:[{required:!0,message:"请输入模型名称",trigger:"change"}]},api_endpoint:{...D,label:"API 域名",placeholder:"请输入您的API 域名",rules:[{required:!0,message:"请输入API 域名",trigger:"change"}]},model_context_length:{...D,label:"模型上下文长度",placeholder:"请输入您的模型上下文长度",rules:[{required:!0,message:"请输入模型上下文长度",trigger:"change"}]},model_uid:{...D,label:"模型UID",placeholder:"请输入您的模型UID",rules:[{required:!0,message:"请输入模型UID",trigger:"change"}]},api_key:{...D,label:"API Key",placeholder:"请输入您的API Key",rules:[{required:!0,message:"请输入API Key",trigger:"change"}]},secret_key:{...D,label:"Secret Key",placeholder:"请输入您的Secret Key",rules:[{required:!0,message:"请输入Secret Key",trigger:"change"}]},api_version:{...je,label:"API 版本",placeholder:"请输入您的API 版本",optionsKey:"api_versions",options:[],rules:[{required:!0,message:"请选择API 版本",trigger:"change"}]},app_id:{...D,label:"appid",placeholder:"请输入appid",rules:[{required:!0,message:"请输入appid",trigger:"change"}]},region:{...D,label:"region",placeholder:"请输入地区",rules:[{required:!0,message:"请输入地区",trigger:"change"}]}};function Qe(a){if(ne[a])return ne[a];let _={...D};return _.placeholder="请输入您的"+a,_}const Ye={columns:[{title:"模型名称",dataIndex:"model_name",key:"model_name",langKey:"views.user.model.model_name"},{title:"模型类型",dataIndex:"model_type",key:"model_type",langKey:"views.user.model.model_type"}],rows:[],showAddBtn:!1},We={azure:{columns:[{title:"部署名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"API版本",dataIndex:"api_version",key:"api_version",langKey:"views.user.model.api_version"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0},ollama:{columns:[{title:"模型名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"BaseURL",dataIndex:"api_endpoint",key:"api_endpoint",langKey:"views.user.model.api_endpoint"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0},openaiAgent:{columns:[{title:"模型名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"BaseURL",dataIndex:"api_endpoint",key:"api_endpoint",langKey:"views.user.model.api_endpoint"},{title:"API Key",dataIndex:"api_key",key:"api_key",langKey:"views.user.model.api_key"},{title:"API版本",dataIndex:"api_version",key:"api_version",langKey:"views.user.model.api_version"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0},xinference:{columns:[{title:"模型名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"服务器地址",dataIndex:"api_endpoint",key:"api_endpoint",langKey:"views.user.model.api_endpoint"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0}},Ze=["azure","ollama","xinference","openaiAgent"];function eo(a){if(Ze.indexOf(a.model_define)>-1)return a.config_list;{let _=[];return a.llm_model_list||(a.llm_model_list=[]),a.llm_model_list.forEach(s=>{_.push({model_name:s,model_type:"LLM"})}),a.vector_model_list||(a.vector_model_list=[]),a.vector_model_list.forEach(s=>{_.push({model_name:s,model_type:"TEXT EMBEDDING"})}),_}}function oo(a){let _=["model_define","model_icon_url"],s=We[a.model_define];return s||(s=Ye),_.forEach(d=>{s[d]=a[d]}),s.rows=eo(a),s}const to={class:"form-wrapper"},lo={class:"model-logo-box"},no=["src"],ao={class:"form-box"},so={class:"form-item-label"},io=["href"],ro={__name:"set-model-alert",emits:["ok"],setup(a,{expose:_,emit:s}){const{t:d}=J(),w=s,u=te.useForm,$=S(""),r=de({model_icon_url:"",model_define:"",model_name:""}),h=S(!1),k=S({}),p=S({}),v=S([]),y=["ollama","xinference","openaiAgent"],N=(b,n)=>{k.value={},p.value={},v.value=[];const{model_icon_url:Q,model_define:Y,config_params:G,model_name:V}=b;$.value=n?d("common.edit")+" "+V:d("common.add")+" "+V,r.model_icon_url=Q,r.model_define=Y,r.model_name=V;let H={},F={},j=[];G.unshift("id"),G.forEach(T=>{T=="model_type"&&(T="model_types"),y.indexOf(b.model_define)>-1&&T=="deployment_name"&&(T="model_name");let e=Qe(T);e.key=T,e.help_links=b.help_links,e.disabled=!1,e.key=="model_types"&&n&&(e.disabled=!0);let I=e.options;n?(y.indexOf(n.model_define)>-1&&n.deployment_name&&(n.model_name=n.deployment_name),F[T]=n[T]||void 0):F[T]=e.defaultValue,e.optionsKey&&b[e.optionsKey]&&(I=b[e.optionsKey]),e.hidden||j.push({...e,options:I,key:T}),e.rules&&(H[T]=e.rules)}),k.value=H,p.value=F,v.value=j,h.value=!0,setTimeout(()=>{l()},100)},{resetFields:f,clearValidate:l,validate:o,validateInfos:x}=u(p,k),B=()=>{o().then(()=>{p.value.id?X():O()}).catch(b=>{})},q=()=>{f(),l()},P=S(!1),O=()=>{let b=R(p.value),n=JSON.parse(JSON.stringify(b));n.model_type=n.model_types,n.model_define=r.model_define,y.indexOf(n.model_define)>-1&&n.model_name&&(n.deployment_name=n.model_name,delete n.model_name),P.value=!0,re(n).then(()=>{P.value=!1,h.value=!1,Z.success(d("common.saveSuccess")),w("ok")}).catch(()=>{P.value=!1})},X=()=>{let b=R(p.value),n=JSON.parse(JSON.stringify(b));n.model_type=n.model_types,n.model_define=r.model_define,y.indexOf(n.model_define)>-1&&n.model_name&&(n.deployment_name=n.model_name,delete n.model_name),P.value=!0,ce(n).then(()=>{P.value=!1,h.value=!1,Z.success(d("common.saveSuccess")),w("ok")}).catch(()=>{P.value=!1})};return _({open:N}),(b,n)=>{const Q=be,Y=Ie,G=Ce,V=Ae,H=Me,F=xe,j=te,T=ee;return t(),M(T,{class:"add-model-alert",width:"650px",open:h.value,"onUpdate:open":n[0]||(n[0]=e=>h.value=e),title:$.value,confirmLoading:P.value,onOk:B,onCancel:q,maskClosable:!1},{default:c(()=>[i("div",to,[i("div",lo,[i("img",{class:"model-logo",src:r.model_icon_url,alt:""},null,8,no)]),i("div",ao,[A(j,{layout:"horizontal","label-col":{span:6},"wrapper-col":{span:18}},{default:c(()=>[(t(!0),m(K,null,U(v.value,e=>(t(),m(K,{key:e.key},[e.hidden?E("",!0):(t(),M(F,ge(he({key:0},C(x)[e.key])),{label:c(()=>[i("div",so,[i("span",null,g(C(d)("views.user.model."+e.key)),1)])]),default:c(()=>[e.componentType=="radio"?(t(),M(Y,{key:0,value:p.value[e.key],"onUpdate:value":I=>p.value[e.key]=I,disabled:e.disabled},{default:c(()=>[(t(!0),m(K,null,U(e.options,(I,W)=>(t(),M(Q,{value:I,key:W},{default:c(()=>[i("span",null,g(I),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","disabled"])):E("",!0),e.componentType=="select"?(t(),M(V,{key:1,value:p.value[e.key],"onUpdate:value":I=>p.value[e.key]=I,placeholder:e.placeholder},{default:c(()=>[(t(!0),m(K,null,U(e.options,(I,W)=>(t(),M(G,{value:I,key:W},{default:c(()=>[i("span",null,g(I),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):E("",!0),e.componentType=="input"?(t(),m(K,{key:2},[A(H,{value:p.value[e.key],"onUpdate:value":I=>p.value[e.key]=I,placeholder:e.placeholder},null,8,["value","onUpdate:value","placeholder"]),e.key=="api_key"?(t(),m("a",{key:0,href:e.help_links,target:"_blank"},g(C(d)("views.user.model.getApikeyText")),9,io)):E("",!0)],64)):E("",!0)]),_:2},1040))],64))),128))]),_:1})])])]),_:1},8,["open","title","confirmLoading"])}}},co=z(ro,[["__scopeId","data-v-48f2f9cd"]]),mo={class:"form-wrapper"},_o={class:"tools-wrapper"},uo=["src"],po={class:"tools-box"},fo={class:"list-box"},vo=["onClick"],yo=["onClick"],go={__name:"see-model-alert",emits:["new","edit","remove"],setup(a,{expose:_,emit:s}){const{t:d}=J(),w=s,u=S(!1),$=["ollama","xinference","openaiAgent"],r=de({model_icon_url:"",model_define:"",columns:[],rows:[],showAddBtn:!1});let h=ke({});const k=f=>{h=f;let l=oo(f);for(let o in l)r[o]=l[o];u.value=!0},p=()=>{u.value=!1,w("new",{...h})},v=f=>{u.value=!1,w("edit",{...h},R(f))},y=f=>{u.value=!1,w("remove",R(f))},N=()=>{};return _({open:k}),(f,l)=>{const o=ae,x=Ke,B=Te,q=$e,P=ee;return t(),M(P,{class:"add-model-alert",width:"800px",open:u.value,"onUpdate:open":l[0]||(l[0]=O=>u.value=O),title:C(d)("views.user.model.modelConfigButton"),footer:null,onOk:N},{default:c(()=>[i("div",mo,[i("div",_o,[i("img",{class:"model-logo",src:r.model_icon_url,alt:""},null,8,uo),i("div",po,[r.showAddBtn?(t(),M(o,{key:0,type:"primary",onClick:p},{default:c(()=>[L(g(C(d)("views.user.model.addModel")),1)]),_:1})):E("",!0)])]),i("div",fo,[A(q,{"data-source":r.rows,scroll:{y:400},pagination:!1},{default:c(()=>[(t(!0),m(K,null,U(r.columns,O=>(t(),m(K,{key:O.key},[O.key=="action"?(t(),M(B,{key:0,title:C(d)("common.action"),"data-index":O.key,width:"140px"},{default:c(({record:X})=>[i("span",null,[i("a",{onClick:b=>v(X)},g(C(d)("common.edit")),9,vo),A(x,{type:"vertical"}),i("a",{onClick:b=>y(X)},g(C(d)("common.remove")),9,yo)])]),_:2},1032,["title","data-index"])):(t(),M(B,{key:1,title:C(d)("views.user.model."+($.indexOf(r.model_define)>-1&&O.key=="deployment_name"?"model_name":O.key)),"data-index":O.key},null,8,["title","data-index"]))],64))),128))]),_:1},8,["data-source"])])])]),_:1},8,["open","title"])}}},ho=z(go,[["__scopeId","data-v-905dacec"]]),ko={class:"user-model-page"},wo={class:"list-wrapper"},xo={__name:"index",setup(a){const{t:_}=J(),s=S(1),d=()=>{},w=S([]),u=oe(()=>w.value.filter(o=>o.listType==1)),$=oe(()=>w.value),r=()=>{me().then(o=>{let x=o.data||[];x.forEach(B=>{B.listType=B.config_list.length>0?1:0}),x.sort((B,q)=>B.listType-q.listType),w.value=x})};r();const h=S(null),k=o=>{h.value.open(o)},p=o=>{y.value.open(o)},v=o=>{y.value.open(o)},y=S(null),N=(o,x)=>{y.value.open(o,x)},f=()=>{r()},l=o=>{ee.confirm({title:_("views.user.model.deleteModel"),icon:A(ie),content:_("views.user.model.deleteModelContent"),onOk(){_e({id:o.id}).then(()=>{Z.success(_("common.deleteSuccessful")),r()})}})};return(o,x)=>(t(),m(K,null,[i("div",ko,[A(Le,{value:s.value,"onUpdate:value":x[0]||(x[0]=B=>s.value=B),onChange:d},null,8,["value"]),i("div",wo,[s.value==1?(t(),M(le,{list:u.value,type:1,key:"addedModelList",onEdit:N,onNew:p,onSee:k,onRemove:l},null,8,["list"])):E("",!0),s.value==0?(t(),M(le,{list:$.value,type:2,key:"canAddModelList",onAdd:v,onSee:k},null,8,["list"])):E("",!0)])]),A(ho,{ref_key:"seeModelAlertRef",ref:h,onNew:p,onEdit:N,onRemove:l},null,512),A(co,{ref_key:"setModelAlertRef",ref:y,onOk:f},null,512)],64))}},ct=z(xo,[["__scopeId","data-v-290d7cb8"]]);export{ct as default};
